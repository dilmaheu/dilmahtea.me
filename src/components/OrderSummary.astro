---
import DynamicHTML from "@components/DynamicHTML.astro";
import productImageSrc from "@components/teatime-rocks.png";
---

<style lang="scss">
  @use "src/styles/poly-fluid" as *;

  .order-summary {
    @media (min-width: 1024px) {
      padding: poly-fluid-clamp(
        (
          1024px: 28px 42px,
          1440px: 32px 56px,
        )
      );
    }
  }

  .order-charges {
    & > div,
    & + div {
      @apply flex justify-between items-center;
    }
  }

  .order-charges > div span {
    &:first-of-type {
      @apply text-[1.125rem];
    }

    &:last-of-type {
      @apply text-[2rem];
    }

    &:first-of-type {
      font-size: poly-fluid-clamp(
        (
          375px: 16px,
          1440px: 18px,
        )
      );
    }

    &:last-of-type {
      line-height: 110%;

      font-size: poly-fluid-clamp(
        (
          375px: 28px,
          1440px: 32px,
        )
      );
    }
  }

  .order-total-container span {
    &:first-of-type {
      font-size: poly-fluid-clamp(
        (
          375px: 18px,
          1440px: 24px,
        )
      );
    }

    &:last-of-type {
      font-size: poly-fluid-clamp(
        (
          375px: 32px,
          1440px: 42px,
        )
      );
    }
  }

  .product-image {
    $fluid-image-size: poly-fluid-clamp(
      (
        375px: 68px,
        1440px: 100px,
      )
    );

    width: $fluid-image-size;
    height: $fluid-image-size;
    min-width: $fluid-image-size;
  }

  .product-name {
    font-size: poly-fluid-clamp(
      (
        375px: 18px,
        1440px: 24px,
      )
    );
  }

  .product-size {
    font-size: poly-fluid-clamp(
      (
        375px: 14px,
        1440px: 16px,
      )
    );
  }
</style>

<div
  class="order-summary text-dark2 flex flex-col justify-between gap-[26px] lg:gap-32"
>
  <div class="flex flex-col gap-5">
    <h5 class="alice text-[1.5rem] sm:text-[1.75rem] leading-[120%]">
      Order Summary
    </h5>

    <DynamicHTML
      htmlFn={(content) =>
        Object.keys(window.cart)
          .map((id) => window.replacePlaceholders(content, window.cart[id]))
          .join("")}
    >
      <div
        class="product p-4 gap-3.5 flex items-center bg-lightgray2 rounded-[10px]"
      >
        <img
          class="product-image"
          src={`<placeholder name="image"></placeholder>`}
          style="clip-path: url(#shipping-product-image)"
        />

        <div class="flex flex-col flex-grow gap-2.5">
          <h6 class="product-name alice leading-[130%]">
            <placeholder name="name"></placeholder> (<placeholder
              name="quantity"></placeholder>)
          </h6>

          <div class="flex justify-between items-center gap-1.5">
            <div class="product-size">
              Size: <placeholder name="size"></placeholder>
            </div>

            <span class="product-price alice text-[1.75rem] leading-[120%]">
              €<placeholder name="price"></placeholder>
            </span>
          </div>
        </div>
      </div>
    </DynamicHTML>
  </div>

  <div class="flex flex-col">
    <div class="order-charges pb-3 flex flex flex-col gap-3">
      <div>
        <span>Subtotal</span>
        <span id="order-subtotal" class="alice">
          €<DynamicHTML htmlFn={() => window.cart.subTotal} />
        </span>
      </div>

      <div>
        <span>Shipping</span>
        <span id="order-shipping-charge" class="alice">
          €<DynamicHTML htmlFn={() => window.cart.shippingCharge} />
        </span>
      </div>

      <div>
        <span>Tax</span>
        <span id="order-tax" class="alice">
          €<DynamicHTML htmlFn={() => window.cart.tax} />
        </span>
      </div>
    </div>

    <div class="order-total-container pt-3 border border-t-lightgreen">
      <span class="font-semibold leading-[130%]">Total</span>
      <span id="order-total" class="alice leading-[110%]">
        €<DynamicHTML htmlFn={() => window.cart.total} />
      </span>
    </div>
  </div>
</div>
