---
import RecurringImages from "@store/RecurringImages";
import ClippedImg from "@components/ClippedImg.astro";
import ClipPathSVG from "@components/ClipPathSVG.astro";
import productImageSrc from "@components/teatime-rocks.png";
import CheckoutFlowBg from "@components/checkout-flow-background.webp";
import CheckoutFlowBgSm from "@components/checkout-flow-background-sm.webp";

const { logo } = RecurringImages;

const products = [
  {
    name: "Chamomile Tea",
    image: "image.png",
    quantity: 2,
    price: 500,
    size: 100,
  },
  {
    name: "Chamomile Tea",
    image: "image.png",
    quantity: 2,
    price: 500,
    size: 100,
  },
];
---

<style lang="scss">
  @use "poly-fluid-sizing" as *;

  .checkout-flow-container {
    @include poly-fluid-sizing(
      "padding",
      (
        375px: 24px 24px,
        1440px: 40px 56px,
      )
    );

    > div {
      @include poly-fluid-sizing(
        "height",
        (
          375px: 38px,
          1440px: 50px,
        )
      );
    }
  }

  .flow {
    > div {
      @apply h-full text-center flex flex-col justify-between items-center;

      span {
        @apply font-medium;

        @include poly-fluid-sizing(
          "font-size",
          (
            375px: 10px,
            1440px: 16px,
          )
        );
      }

      div {
        @apply w-full rounded-full bg-lightgray2;

        @include poly-fluid-sizing(
          "height",
          (
            375px: 5px,
            1440px: 8px,
          )
        );
      }
    }
  }

  form {
    > .form-grid-container {
      @apply flex flex-col gap-6;

      h4 {
        @apply font-normal text-primary text-[2rem] leading-[110%];
      }

      .form-grid {
        @apply w-full grid sm:grid-cols-2 gap-y-2.5 sm:gap-y-6 sm:gap-x-24;

        label {
          @apply flex flex-col gap-1.5;

          span {
            @apply font-medium text-dark sm:text-[1.125rem];
          }

          input,
          select {
            @apply focus:ring focus:ring-emerald-800 focus:ring-opacity-20 focus:outline-none;
            @apply h-12 bg-lightgray py-3 px-4 border border-primary rounded-full text-dark sm:text-[1.125rem];
          }
        }
      }
    }
  }

  .order-summary-charges {
    & > div,
    & + div {
      @apply flex justify-between items-center;
    }
  }

  .order-summary-charges > div span {
    &:first-of-type {
      @apply text-[1.125rem];
    }

    &:last-of-type {
      @apply text-[2rem] leading-[110%];
    }
  }
</style>

<div
  id="checkout"
  class="hidden fixed top-0 left-0 z-[1000] w-full h-full bg-lightgray overflow-auto"
>
  <section class="checkout-flow-container relative">
    <img
      class="absolute top-0 left-0 -z-10 w-full h-full"
      alt=""
      src={CheckoutFlowBg}
      sizes="(min-width: 1440px) 1440px, 100vw"
      srcset={`${CheckoutFlowBgSm} 640w, ${CheckoutFlowBg} 1440w`}
    />

    <div class="flex justify-between gap-[5vw]">
      <img {...logo} />

      <div class="flow flex-grow grid grid-cols-4 gap-[3.25vw]">
        <div><span>Cart</span> <div></div></div>

        <div><span>Information</span> <div class="opacity-60"></div></div>

        <div><span>Shipping details</span> <div class="opacity-30"></div></div>

        <div><span>Payment</span> <div class="opacity-30"></div></div>
      </div>
    </div>
  </section>

  <section id="checkout-contact-info" class="hidden flex">
    <form class="flex flex-col gap-12 py-8 px-6 sm:px-14 w-full sm:w-2/3">
      <div class="form-grid-container">
        <h4 class="alice">Contact info</h4>

        <div class="form-grid">
          <label>
            <span>Email Address</span>

            <input
              type="text"
              name="email"
              placeholder="Enter your email address"
            />
          </label>
        </div>
      </div>

      <div class="form-grid-container">
        <h4 class="alice">Shipping Address</h4>

        <div class="form-grid">
          <label>
            <span>First Name</span>

            <input
              type="text"
              name="first_name"
              placeholder="Enter your first name"
            />
          </label>

          <label>
            <span>Last Name</span>

            <input
              type="text"
              name="last_name"
              placeholder="Enter your last name"
            />
          </label>

          <label>
            <span>Country</span>

            <select name="country">
              <option selected disabled hidden>Select your country</option>
              <option value="nl">Nederland</option>
              <option value="en">England</option>
              <option value="de">Germany</option>
            </select>
          </label>

          <label>
            <span>City</span>
            <input type="text" name="city" placeholder="Enter your city" />
          </label>

          <label>
            <span>Street</span>

            <input
              type="text"
              name="address"
              placeholder="Enter your street address"
            />
          </label>

          <label>
            <span>Postal Code</span>

            <input
              type="text"
              name="postal_code"
              placeholder="Enter your postal code"
            />
          </label>
        </div>
      </div>

      <div
        class="flex flex-col sm:flex-row items-center justify-center sm:justify-start gap-9 sm:gap-12"
      >
        <button
          class="w-full sm:w-auto py-4 px-20 sm:px-24 bg-primary text-lightgray font-bold rounded-full"
        >
          Continue To Shipping
        </button>

        <button class="text-primary font-bold">Return To Cart</button>
      </div>
    </form>

    <div
      class:list={[
        "sm:w-1/3 sm:border sm:border-l-lightgreen",
        "hidden py-9 px-14 text-dark2 sm:flex flex-col justify-between gap-2.5",
      ]}
    >
      <div class="flex flex-col gap-5">
        <h5 class="alice text-[1.75rem] leading-[120%]">Order Summary</h5>

        <ClipPathSVG
          id="shipping-product-image"
          path="M0.516,0.008 C0.36,0.008,0.1,-0.008,0.04,0.082 C-0.021,0.172,0.002,0.495,0.017,0.736 C0.032,0.978,0.182,1,0.528,1 C0.813,1,0.902,0.936,0.974,0.717 C1,0.624,1,0.395,0.946,0.128 C0.897,-0.045,0.735,0.008,0.516,0.008"
        />

        {
          products.map(({ name, image, quantity, price, size }) => (
            <div class="p-4 gap-3.5 flex items-center bg-lightgray2 rounded-[10px]">
              <div
                class="flex"
                style="min-width: 100px; width: 100px; height: 100px;"
              >
                <img
                  class="w-full h-full"
                  src={productImageSrc}
                  style="clip-path: url(#shipping-product-image)"
                />
              </div>

              <div class="flex flex-col flex-grow gap-2.5">
                <h6 class="alice text-[1.5rem] leading-[130%]">
                  {name} ({quantity})
                </h6>

                <div class="flex justify-between items-center gap-1.5">
                  <div>Size: {size}gm</div>

                  <span class="alice text-[1.75rem] leading-[120%]">
                    ${price}
                  </span>
                </div>
              </div>
            </div>
          ))
        }
      </div>

      <div class="flex flex-col">
        <div class="order-summary-charges pb-3 flex flex flex-col gap-3">
          <div><span>Subtotal</span> <span class="alice">$1000</span></div>

          <div><span>Shipping</span> <span class="alice">$100</span></div>

          <div><span>Tax</span><span class="alice">$50</span></div>
        </div>

        <div class="pt-3 border border-t-lightgreen">
          <span class="font-semibold text-[1.5rem] leading-[130%]">Total</span>
          <span class="alice text-[2.625rem] leading-[110%]">$50</span>
        </div>
      </div>
    </div>
  </section>
</div>
