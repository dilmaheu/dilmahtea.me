---
import getLocalesData from "@utils/getLocalesData";

const { locales } = await getLocalesData();
---

<script is:inline define:vars={{ locales }}>
  const browserLocale = navigator.language.substring(0, 2);

  let preferredLocale = localStorage.getItem("locale");

  if (!locales.includes(preferredLocale)) {
    // set preferredLocale if null or reset if not supported
    preferredLocale = locales.includes(browserLocale) ? browserLocale : "en";

    localStorage.setItem(`locale`, preferredLocale);
  }

  window.availableLocales = locales;
  window.preferredLocale = preferredLocale;
</script>
